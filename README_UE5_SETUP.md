# UE5エディタでのMCPプラグイン設定手順

このドキュメントでは、Unreal Engine 5エディタでModel Context Protocol (MCP)プラグインを設定し実行する手順を説明します。

## 前提条件

- Unreal Engine 5.5がインストールされていること
- MCPサーバーが起動していること
- BlenderとMCPの連携が設定されていること

## UE5プロジェクトの作成

まず、新しいUE5プロジェクトを作成するか、既存のプロジェクトを使用します。

1. Unreal Engine 5を起動
2. 「ゲーム」カテゴリから「ブランク」テンプレートを選択
3. プロジェクト名を「MCPGame」に設定（任意の名前でOK）
4. 保存先を `/Users/tacyan/Documents/MCPGame` に設定（`.env`ファイルのパスと一致させる）
5. 「プロジェクトを作成」をクリック

## MCPプラグインの設定

UE5プロジェクトが開いたら、以下の手順でMCPプラグインを設定します：

1. エディタの「ウィンドウ」メニューから「Pythonスクリプトエディタ」を開く
2. スクリプトエディタで「ファイル」→「開く」を選択
3. `/Users/tacyan/dev/UE5-MCP/ue5_plugin/mcp_plugin.py` ファイルを開く
4. 必要に応じてパスなどの設定を調整（通常は不要）
5. スクリプトエディタの「実行」ボタンをクリック、またはAlt+Pキーを押してスクリプトを実行

正常に実行されると、以下のメッセージがログに表示されます：
```
UE5 MCPプラグインを初期化しています...
UE5 MCP APIサーバーを開始しました - ポート: 9082
MCPサーバーURL: http://127.0.0.1:8080
MCPサーバーに接続しました
MCPフレームワークが正常に初期化されました！
初期化完了 - UE5 MCPプラグインは実行中です
```

## 宝箱狩りゲームの作成

MCPプラグインが正常に実行された後、宝箱狩りゲームを作成することができます：

1. ターミナルで以下のコマンドを実行して、MCPサーバーを起動（既に実行中なら不要）
   ```
   python mcp_server.py
   ```

2. 別のターミナルで、宝箱狩りゲームの作成スクリプトを実行
   ```
   python run_mcp_treasure_game.py
   ```

3. UE5エディタ内でゲームが自動的に作成されるのを確認（レベル、ブループリント、アセットが生成される）

## トラブルシューティング

### MCPサーバーに接続できない場合

- MCPサーバーが起動しているか確認
- `.env`と`mcp_settings.json`のポート設定が正しいか確認（`MCP_SERVER_PORT=8080`）
- ファイアウォールやネットワーク設定を確認

### UE5エディタでスクリプトの実行に失敗する場合

- UE5エディタを管理者権限で実行してみる
- Pythonモジュールのパスが正しいか確認
- エディタを再起動する

### アセットのインポートに失敗する場合

- エクスポートパスとインポートパスが正しいか確認
- 手動でアセットをインポートして、UE5の設定が正しいか確認
- MCPサーバーのログを確認して、エラーメッセージを確認

## マニュアル実行方法

UE5エディタのPythonスクリプトコンソールから手動でコマンドを実行することも可能です：

```python
import unreal
import sys

# MCPプラグインのパスを追加
sys.path.append("/Users/tacyan/dev/UE5-MCP/ue5_plugin")

# MCPプラグインをインポート
import mcp_plugin

# プラグインを初期化
plugin = mcp_plugin.MCPPlugin()

# コマンドを実行（例：レベル作成）
plugin.create_level("TreasureHuntMap", "Default")
```

これでUE5エディタでMCPプラグインを使用してゲームを作成する設定が完了しました。 
